!function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(o,i,function(t){return e[t]}.bind(null,i));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t){const n=io.connect("//"+document.domain+":"+location.port);let o=0;const i=document.getElementById("canvas");i.addEventListener("contextmenu",function(e){e.preventDefault()},!1);const r=i.getContext("2d");window.innerWidth<500&&(i.width=270,i.height=290);const c=i.width/2,u=i.height/2;let a=0,s=0,l=0,f=0,d=0,h=0;const p=new Image;p.src="static/tilesheet.png";const m=new Image;m.src="static/charsheet.png";let v=[],y={},g={};r.font="11pt Verdana",r.textAlign="end";const w=i.clientWidth,b=i.clientHeight-20;function k(){r.clearRect(0,0,i.width,i.height);for(let e=0;e<w;e+=a){const t=e/a+(s-d);for(let n=0;n<b;n+=a){const o=v[n/a+(l-h)][t];if(Array.isArray(o))for(const t in o)E(o[t],e,n);else E(o,e,n)}}!function(){for(const e in g)if(e!=o){const t=g[e].cx,n=g[e].cy,o=t-s,i=n-l;o>=-d&&o<=d&&i>=-h&&i<=h&&S(o+d,i+h,g[e].direction)}}(),m.complete?S(d,h,f):m.addEventListener("load",S),r.fillStyle="white",r.fillRect(0,i.height-20,i.width,20),r.strokeText("("+s+", "+l+")",14*a+30,15*a+15)}function E(e,t,n){r.beginPath(),p.complete?O(e,t,n):p.load=O.bind(e,t,n),r.moveTo(t,n),r.lineTo(t+a,n),r.moveTo(t,n),r.lineTo(t,n+a),r.stroke(),r.closePath()}function S(e,t,n){r.strokeStyle="transparent",r.drawImage(m,n*a,0,a,a,e*a,t*a,a,a)}function O(e,t,n){r.strokeStyle="transparent",r.drawImage(p,e%10*a,Math.floor(e/10)*a,a,a,t,n,a,a)}function L(e){[32,37,38,39,40,65,68,69,83,87].includes(e.keyCode)&&(e.preventDefault(),j(),x(),32==e.keyCode?console.log("Eventually we will implement the spacebar for interacting with items below your character."):69==e.keyCode&&console.log("Eventually we will implement the 'e' key for interacting with nearby npcs and objects, if your player is facing them!"),n.emit("json",JSON.stringify({user:o,action:e.keyCode})))}function C(e){const t=e.offsetX,n=e.offsetY,o=c-15,r=c-15;_(4,[o,r,r,o],[o,o,r,r],t,n)?L({keyCode:32,preventDefault:function(){}}):_(3,[0,c,i.width],[0,u,0],t,n)?L({keyCode:38,preventDefault:function(){}}):_(3,[0,c,i.width],[i.height,u,i.height],t,n)?L({keyCode:40,preventDefault:function(){}}):_(3,[0,c,0],[0,u,i.height],t,n)?L({keyCode:37,preventDefault:function(){}}):_(3,[i.width,c,i.width],[0,u,i.height],t,n)&&L({keyCode:39,preventDefault:function(){}}),i.addEventListener("mouseup",x),i.addEventListener("touchend",x)}function _(e,t,n,o,i){let r,c,u=!1;for(r=0,c=e-1;r<e;c=r++)n[r]>i!=n[c]>i&&o<(t[c]-t[r])*(i-n[r])/(n[c]-n[r])+t[r]&&(u=!u);return u}function j(){document.removeEventListener("keydown",L),document.addEventListener("keydown",L)}function x(){i.removeEventListener("mousedown",C),i.removeEventListener("touchstart",C),i.removeEventListener("mouseup",x),i.removeEventListener("touchend",x),i.addEventListener("mousedown",C),i.addEventListener("touchstart",C)}let D;!function(){function e(t){D?t-D>100&&k():(D=t,k()),requestAnimationFrame(e)}n.on("connect",function(){j(),x()}),n.on("init_data",function(t){t=JSON.parse(t),o=t[0],s=t[1][0],l=t[1][1],f=t[1][2],v=t[2].map,a=t[3][0],i.width<450?(d=4,h=4):(d=t[3][1],h=t[3][2]),e()}),n.on("tiles",function(e){y=JSON.parse(e)}),n.on("map_data",function(e){e=JSON.parse(e)}),n.on("movement_self",function(e){var t;e=JSON.parse(e),o==e.user&&(s=(t=e).cx,l=t.cy,f=t.direction)}),n.on("update_all",function(e){g=JSON.parse(e)}),n.on("failure",function(e){console.log("Unsynchronized.")})}()}]);